# ERC721

Source: [`tokens/ERC721.sol`](https://github.com/Vectorized/solady/blob/main/src/tokens/ERC721.sol)

Solady's ERC7210 token implementation is an opinionated and highly optimized implementation of the [ERC721 standard](https://eips.ethereum.org/EIPS/eip-721).

## Things to note

- The ERC721 standard allows for self approvals. As such, this implementation **WILL NOT** revert for such an action.
- Functions are made payable, where permitted by the ERC721 standard, to reduce on gas costs.
- Every function can be overridden with the `override` keyword if a custom implementation is required.
- The `safeTransfer` functions uses the identity precompile (0x4).

## API Reference

### name

Returns the token collection name.

```solidity
function name() public view virtual returns (string memory)
```

#### Parameter(s)

- None

#### Return Value(s)

- string: The token collection name.

#### Note(s)

- Must override or the contract will not compile.

---

### symbol

Returns the token collection symbol.

```solidity
function symbol() public view virtual returns (string memory)
```

#### Parameter(s)

- None

#### Return Value(s)

- string: The token collection symbol.

#### Note(s)

- Must override or the contract will not compile.

---

### tokenURI

Returns the Uniform Resource Identifier (URI) for a token id.

```solidity
function tokenURI(uint256) public view virtual returns (string memory)
```

#### Parameter(s)

- uint256: The token id to query the URI of.

#### Return Value(s)

- string: The URI for the input token id.

#### Note(s)

- Must override or the contract will not compile.

---

### ownerOf

Returns the owner of a token id.

```solidity
function ownerOf(uint256) public view virtual returns (address)
```

#### Parameter(s)

- uint256: The id to query the owner of.

#### Return Value(s)

- address: The owner address of the input id.

#### Note(s)

- Reverts with the `TokenDoesNotExist` error if the input id does not have an owner.

---

### balanceOf

Returns the number of tokens owned by an address.

```solidity
function balanceOf(address) public view virtual returns (uint256)
```

#### Parameter(s)

- address: The address to query the token balance of.

#### Return Value(s)

- uint256: The number of tokens owned by the input address.

#### Note(s)

- Reverts with `BalanceQueryForZeroAddress` error if the input address is the zero address.

---

### getApproved

Returns the address approved to manage a token id. 

```solidity
function getApproved(uint256) public view virtual returns (address) 
```

#### Parameter(s)

- uint256: The input token id to query the approved address of.

#### Return Value(s)

- address: The address approved to manage the input token id. 

#### Note(s)

- Reverts with the `TokenDoesNotExist` error if the input id does not have an owner.

---

### approve

Sets an address as the approved account to manage a token id.

```solidity
function approve(address,uint256) public payable virtual
```

#### Parameter(s)

- address: The address to be approved.
- uint256: The token id whose approved address is to be updated.

#### Return Value(s)

- None

#### Note(s)

- Emits the `Approval` event.
- Reverts with the `TokenDoesNotExist` error if the input id does not have an owner.
- Reverts with the `NotOwnerNorApproved` error if the caller is not the owner or the approved address.

---

### isApprovedForAll

Returns whether an address is approved to manage the tokens on behalf of an owner.

```solidity
function isApprovedForAll(address,address) public view virtual returns (bool)
```

#### Parameter(s)

- address: The owner address to query the approved address of.
- address: The operator address to query against the existing approved address.

#### Return Value(s)

- bool: `true` if the input operator address is the address that is approved to manage the tokens on behalf of the input owner address. Otherwise, return false. 

#### Note(s)

- None

---

### setApprovalForAll

Sets the approval for an address to manage the tokens of the caller.

```solidity
function setApprovalForAll(address,bool) public virtual
```

#### Parameter(s)

- address: The operator address to update approval of.
- bool: The approval value.

#### Return Value(s)

- None 

#### Note(s)

- Emits the `ApprovalForAll` event.

---

### transferFrom

Transfers the token with id from its owner to a recipient.

```solidity
function transferFrom(address,address,uint256) public payable virtual 
```

#### Parameter(s)

- address: The owner of the token.
- address: The recipient of the token.
- uint256: The id of the token to be transferred

#### Return Value(s)

- None

#### Note(s)

- Emits the `Transfer` event.
- Reverts with the `TokenDoesNotExist` error if the token associated with the input id does not have an owner.
- Reverts with the `TransferFromIncorrectOwner` error if the owner of token associated with the input id is not the same as the input owner address.
- Reverts with the `TransferToZeroAddress` error if the input recipient address is the zero address.
- Reverts with the `NotOwnerNorApproved` error if the caller is not the owner or the approved address.
- Reverts with the `AccountBalanceOverflow` error if the balance of the input recipient address has overflowed.

---

### safeTransferFrom

Transfers the token with id from its owner to a recipient. 

```solidity
function safeTransferFrom(address,address,uint256) public payable virtual 
```

#### Parameter(s)

- address: The owner of the token.
- address: The recipient of the token.
- uint256: The id of the token to be transferred

#### Return Value(s)

- None 

#### Note(s)

- Emits the `Transfer` event.
- Reverts with the `TokenDoesNotExist` error if the token associated with the input id does not have an owner.
- Reverts with the `TransferFromIncorrectOwner` error if the owner of token associated with the input id is not the same as the input owner address.
- Reverts with the `TransferToZeroAddress` error if the input recipient address is the zero address.
- Reverts with the `NotOwnerNorApproved` error if the caller is not the owner or the approved address.
- Reverts with the `AccountBalanceOverflow` error if the balance of the input recipient address has overflowed.
- Reverts with the `TransferToNonERC721ReceiverImplementer` error if the call to `onERC721Received` returns successfully with a value that is not `onERC721ReceivedSelector`.
- Reverts if the call to `onERC721Received` returns unsuccessfully.

---

### safeTransferFrom

Transfers the token with id from its owner to a recipient. 

```solidity
function safeTransferFrom(address,address,uint256,bytes) public payable virtual 
```

#### Parameter(s)

- address: The owner of the token.
- address: The recipient of the token.
- uint256: The id of the token to be transferred
- bytes: The data to be passed into the onERC721Received callback function

#### Return Value(s)

- None 

#### Note(s)

- Emits the `Transfer` event.
- Reverts with the `TokenDoesNotExist` error if the token associated with the input id does not have an owner.
- Reverts with the `TransferFromIncorrectOwner` error if the owner of token associated with the input id is not the same as the input owner address.
- Reverts with the `TransferToZeroAddress` error if the input recipient address is the zero address.
- Reverts with the `NotOwnerNorApproved` error if the caller is not the owner or the approved address.
- Reverts with the `AccountBalanceOverflow` error if the balance of the input recipient address has overflowed.
- Reverts with the `TransferToNonERC721ReceiverImplementer` error if the call to `onERC721Received` returns successfully with a value that is not `onERC721ReceivedSelector`.
- Reverts if the call to `onERC721Received` returns unsuccessfully.

---

### supportsInterface

 Returns `true` if this contract implements the interface defined by an interfaceId.

```solidity
function supportsInterface(bytes4) public view virtual returns (bool) 
```

#### Parameter(s)

- bytes4: The interfaceId to query against 

#### Return Value(s)

- bool: `true` if contract implements the input interfaceId. Otherwise, return `false`.

#### Note(s)

- This function call must use less than 30_000 gas.
- See [EIP165](https://eips.ethereum.org/EIPS/eip-165) for more information.

---

### Errors

| Name                                   | Description                                                                                             | Selector     |
| -------------------------------------- | ------------------------------------------------------------------------------------------------------- | ------------ |
| NotOwnerNorApproved                    | Thrown when a caller tries to perform an action on a token id that they do not own or have approval of. | `0xe5cfe957` |
| TokenDoesNotExist                      | Thrown when a caller tries to perform an action on a token id that does not exist.                      | `0xf9067066` |
| TokenAlreadyExists                     | Thrown when a caller tries to perform an action on a token id that already exists.                      | `0x8301ab38` |
| BalanceQueryForZeroAddress             | Thrown when a caller tries to query the token balance of the zero address.                              | `0xf4d678b8` |
| TransferToZeroAddress                  | Thrown when a caller tries to transfer a token to the zero address.                                     | `0xddafbaef` |
| TransferFromIncorrectOwner             | Thrown when a caller tries to transfer a token from an address who does not own the token.              | `0x1a15a3cc` |
| AccountBalanceOverflow                 | Thrown when the balance of an address has overflowed.                                                   | `0x1a15a3cc` |
| TransferToNonERC721ReceiverImplementer | Thrown when the recipient contract does not contain the `_checkOnERC721Received` function.              | `0x1a15a3cc` |

### Events

| Name                                 | Description                                                             |
| ------------------------------------ | ----------------------------------------------------------------------- |
| Transfer(address,address,uint256)    | Emitted when a token is transferred from a sender to a recipient.       |
| Approval(address,address,uint256)    | Emitted when an owner approves a spender to manage a specific token.    |
| ApprovalForAll(address,address,bool) | Emitted when an owner approves a spender to manage all of their tokens. |

### Constants

| Name                               | Value                                                              |
| ---------------------------------- | ------------------------------------------------------------------ |
| \_TRANSFER_EVENT_SIGNATURE         | 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef |
| \_APPROVAL_EVENT_SIGNATURE         | 0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925 |
| \_APPROVAL_FOR_ALL_EVENT_SIGNATURE | 0x17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c31 |
| \_MAX_ACCOUNT_BALANCE              | 0xffffffff                                                         |
| \_ERC721_MASTER_SLOT_SEED          | 0x7d8825530a5a2e7a000000000000000000000000000000000000000000000000 |
| \_ERC721_MASTER_SLOT_SEED_MASKED   | 0x0a5a2e7a00000000                                                 |
